---
- name: Add data to ingest
  hosts: forwarders
  any_errors_fatal: true
  gather_facts: no
  become: yes
  become_user: root
  vars_files:
    - /home/ansible/build/vars/main.yml

  tasks:
  
  - name: Configuring UF
    block:
      - name: Pulling data
        unarchive: 
          src: 'http://log-sharing.dreamhosters.com/hnet-hon-var-log-08302005.tar.bz2'
          dest: /tmp
          owner: root
          group: root
          remote_src: yes

      # - name: Pulling data
      #   unarchive: 
      #     src: 'http://log-sharing.dreamhosters.com/hnet-hon-10122004-var.tar.bz2'
      #     dest: /tmp
      #     owner: root
      #     group: root
      #     remote_src: yes    
  
      - command: find /tmp/var -type d -empty -delete

      - name: Copying files to proper location
        copy: 
          src: /tmp/var/
          dest: /opt/
          remote_src: yes
          owner: splunk
          group: splunk

      - file:
          path: /tmp/var/
          state: absent
    when: inventory_hostname == 'UF1'
