# Updating serverclass.conf to include input data
---
- name: Testing Splunk Ansible Build
  hosts: IDX1
  any_errors_fatal: true
  gather_facts: no
  # become: yes
  # become_user: root
  vars_files:
    - ~/build/vars/main_vars.yml

  tasks:

  - name: Updating serverclass.conf
    lineinfile:
      path:  /home/ansible/build/files/serverclass_test.conf
      line: "[serverClass:cluster_manager:app:spe_network_inputs]"
    delegate_to: localhost

  - lineinfile:
      path:  /home/ansible/build/files/serverclass_test.conf
      insertafter: .spe_network_inputs
      line: "{{ item }}"
    loop:
      - "restartSplunkWeb = 0"
      - "restartSplunkd = 0"
      - "stateOnClient = noop"
    delegate_to: localhost